<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>B·∫£ng th√¥ng b√°o - X√£ Ph√∫ M·ªπ</title>

<style>
/* ===== T·∫æT B√çNH NG·ªå 2026 ===== */
body {
    margin: 0;
    background:
        radial-gradient(circle at top, rgba(255,215,0,0.08), transparent 40%),
        linear-gradient(to bottom, #4a0000, #120000);
    color: #fff8e1;
    font-family: "Segoe UI", Arial, sans-serif;
    overflow: hidden;
}

/* ===== HEADER ===== */
#header {
    height: 70px;
    background: linear-gradient(to right, #8b0000, #d32f2f, #8b0000);
    color: #ffeb3b;
    font-size: 26px;
    font-weight: bold;
    text-align: center;
    line-height: 70px;
    text-transform: uppercase;
    letter-spacing: 2px;
    text-shadow: 0 0 6px rgba(255,215,0,0.8);
    position: relative;
}

#header::before,
#header::after {
    content: "üêé";
    position: absolute;
    top: 8x;
    font-size: 60px;
}
#header::before { left: 20px; }
#header::after { right: 20px; }

/* ===== VIEWPORT ===== */
#viewport {
    height: calc(100vh - 70px);
    overflow-y: auto;
    padding: 10px 18px;
}
#viewport::-webkit-scrollbar { width: 0; }

/* ===== CONTROLS ===== */
#controls {
    position: fixed;
    top: 15px;
    right: 15px;
    z-index: 999;
}
#controls button {
    padding: 8px 16px;
    font-weight: bold;
    border-radius: 20px;
    border: 2px solid #ffeb3b;
    background: linear-gradient(to bottom, #ffd700, #f9a825);
    color: #7a0000;
    font-size: 16px;
    cursor: pointer;
    margin-right: 90px;
}

/* ===== SECTION HEADER ===== */
.section-header {
    margin-top: 30px;
    margin-bottom: 10px;
    padding: 14px;
    background: linear-gradient(to right, #7a0000, #b71c1c);
    border-left: 10px solid #ffeb3b;
    font-size: 26px;
    font-weight: bold;
    color: #ffeb3b;
    text-transform: uppercase;
}

/* ===== TABLE ===== */
table {
    width: 100%;
    border-collapse: collapse;
    font-size: 32px;
    table-layout: fixed;
    background: rgba(0,0,0,0.35);
    margin-bottom: 30px;
}
th, td {
    border: 1px solid rgba(255,215,0,0.35);
    padding: 14px 10px;
    vertical-align: middle;
}
thead th {
    background: linear-gradient(to bottom, #a00000, #6a0000);
    color: #ffeb3b;
    position: sticky;
    top: -11px;
    z-index: 10;
}

/* ===== JOBS TABLE WIDTH ===== */
#table-jobs th:nth-child(1), #table-jobs td:nth-child(1) { width: 30%; text-align: justify; }
#table-jobs th:nth-child(2), #table-jobs td:nth-child(2) { width: 6%; text-align: center; }
#table-jobs th:nth-child(3), #table-jobs td:nth-child(3) { width: 10%; text-align: center; }
#table-jobs th:nth-child(4), #table-jobs td:nth-child(4) { width: 8%; text-align: center; }
#table-jobs th:nth-child(5), #table-jobs td:nth-child(5) { width: 12%; text-align: center; }
#table-jobs th:nth-child(6), #table-jobs td:nth-child(6) { width: 6%; text-align: center; }
#table-jobs th:nth-child(7), #table-jobs td:nth-child(7) { width: 11%; text-align: center; }
#table-jobs th:nth-child(8), #table-jobs td:nth-child(8) { width: 8%; text-align: center; }

/* ===== MEETINGS TABLE ===== */
#table-meetings th:nth-child(1), #table-meetings td:nth-child(1) {
    width: 10%; text-align: center; color: #ffeb3b; font-weight: bold;
}
#table-meetings th:nth-child(2), #table-meetings td:nth-child(2) {
    width: 10%; text-align: center; color: #ff5252; font-weight: bold;
}
#table-meetings th:nth-child(3), #table-meetings td:nth-child(3) {
    width: 30%; text-align: justify;
}
#table-meetings th:nth-child(4), #table-meetings td:nth-child(4) {
    width: 15%; text-align: justify;
}
#table-meetings th:nth-child(5), #table-meetings td:nth-child(5) {
    width: 20%; font-style: italic; white-space: normal;
}

/* ===== STATUS ===== */
.status-bad {
    background: linear-gradient(to right, #b71c1c, #ff5252);
    padding: 4px 10px;
    border-radius: 20px;
    font-weight: bold;
    color: #fff;
}

.no-data {
    text-align: center;
    padding: 40px;
    color: #ffd54f;
    font-style: italic;
    font-size: 22px;
}
/* ===== HOA MAI V√ÄNG PH√çA TR√äN (CSS THU·∫¶N ‚Äì TV N√ÄO C≈®NG TH·∫§Y) ===== */
/* ===== HOA MAI 5 C√ÅNH ‚Äì CSS THU·∫¶N ===== */
.mai-top {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 140px;
    pointer-events: none;
    z-index: 999;

    background:
    /* Hoa 1 */
    radial-gradient(circle at 10% 50%, #ffb300 0 4px, transparent 5px),
    radial-gradient(circle at 9% 45%,  #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 11% 45%, #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 9% 55%,  #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 11% 55%, #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 10% 50%, #fff176 0 12px, transparent 13px),

    /* Hoa 2 */
    radial-gradient(circle at 30% 40%, #ffb300 0 4px, transparent 5px),
    radial-gradient(circle at 29% 35%, #ffeb3b 0 9px, transparent 10px),
    radial-gradient(circle at 31% 35%, #ffeb3b 0 9px, transparent 10px),
    radial-gradient(circle at 29% 45%, #ffeb3b 0 9px, transparent 10px),
    radial-gradient(circle at 31% 45%, #ffeb3b 0 9px, transparent 10px),
    radial-gradient(circle at 30% 40%, #fff176 0 11px, transparent 12px),

    /* Hoa 3 */
    radial-gradient(circle at 55% 55%, #ffb300 0 4px, transparent 5px),
    radial-gradient(circle at 54% 50%, #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 56% 50%, #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 54% 60%, #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 56% 60%, #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 55% 55%, #fff176 0 12px, transparent 13px),

    /* Hoa 4 */
    radial-gradient(circle at 75% 40%, #ffb300 0 4px, transparent 5px),
    radial-gradient(circle at 74% 35%, #ffeb3b 0 9px, transparent 10px),
    radial-gradient(circle at 76% 35%, #ffeb3b 0 9px, transparent 10px),
    radial-gradient(circle at 74% 45%, #ffeb3b 0 9px, transparent 10px),
    radial-gradient(circle at 76% 45%, #ffeb3b 0 9px, transparent 10px),
    radial-gradient(circle at 75% 40%, #fff176 0 11px, transparent 12px),

    /* Hoa 5 */
    radial-gradient(circle at 90% 55%, #ffb300 0 4px, transparent 5px),
    radial-gradient(circle at 89% 50%, #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 91% 50%, #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 89% 60%, #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 91% 60%, #ffeb3b 0 10px, transparent 11px),
    radial-gradient(circle at 90% 55%, #fff176 0 12px, transparent 13px);

    background-repeat: no-repeat;
}

</style>
</head>

<body>
<div class="mai-top"></div>
<div id="header">
    B·∫¢NG THEO D√ïI C√îNG VI·ªÜC & L·ªäCH C√îNG T√ÅC
</div>

<div id="controls">
    <button id="btnToggle" onclick="toggleScroll()">‚èØ D·ª´ng / Ch·∫°y</button>
</div>

<div id="viewport">
    <div class="section-header">üìã THEO D√ïI C√îNG VI·ªÜC & VƒÇN B·∫¢N</div>
    <table id="table-jobs">
        <thead></thead>
        <tbody></tbody>
    </table>

    <div class="section-header">
        üìÖ L·ªäCH H·ªåP H√îM NAY (<span id="today-date"></span>)
    </div>
    <table id="table-meetings">
        <thead></thead>
        <tbody></tbody>
    </table>

    <div style="height:150px"></div>
</div>
<script>
const API_KEY = "AIzaSyDWQsIW0i67F2nVSEpMq3Rj_oT228rVsCU";
const SHEET_ID = "15QTF-k5nHtDqyTJ5m_LwGxPjPq0XHTFq5KLOCG9IQIg";
const SHEET_JOBS = "B·∫£ng th√¥ng b√°o ƒëi·ªán t·ª≠";
const SHEET_MEETINGS = "L·ªãch h·ªçp 2026";

let y = 0;
let running = true;
let isReloading = false;
let timer = null;

/* ===== H√ÄM H·ªñ TR·ª¢ ===== */
function parseVNDate(str) {
    if (!str) return null;
    const p = str.split("/");
    if (p.length !== 3) return null;
    return new Date(p[2], p[1] - 1, p[0]);
}

function isNotCompleted(status) {
    if (!status) return true;
    return !status.toLowerCase().includes("ho√†n th√†nh");
}

/* ===== INIT ===== */
async function init() {
    const now = new Date();
    document.getElementById("today-date").textContent =
        now.toLocaleDateString("vi-VN");

    try {
        const [resJobs, resMeetings] = await Promise.all([
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${encodeURIComponent(SHEET_JOBS)}!A1:H100?key=${API_KEY}`),
            fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${encodeURIComponent(SHEET_MEETINGS)}!A1:F100?key=${API_KEY}`)
        ]);

        const dataJobs = await resJobs.json();
        const dataMeetings = await resMeetings.json();

        renderJobsTable(dataJobs.values);
        renderTodayMeetings(dataMeetings.values);

        setTimeout(startAutoScroll, 2000);
    } catch (e) {
        console.error("L·ªói t·∫£i d·ªØ li·ªáu:", e);
    }
}

/* ===== B·∫¢NG C√îNG VI·ªÜC ===== */
function renderJobsTable(rows) {
    if (!rows || rows.length < 2) return;

    const table = document.getElementById("table-jobs");
    const headers = rows[0];

    table.querySelector("thead").innerHTML =
        "<tr>" + headers.map(h => `<th>${h}</th>`).join("") + "</tr>";

    const statusIdx = headers.findIndex(h =>
        h.toLowerCase().includes("tr·∫°ng th√°i")
    );

    const deadlineIdx = headers.findIndex(h =>
        h.toLowerCase().includes("th·ªùi h·∫°n")
    );

    const today = new Date();
    today.setHours(0,0,0,0);

    const tomorrow = new Date(today);
    tomorrow.setDate(today.getDate() + 1);

    let html = "";

    rows.slice(1).forEach(row => {
        if (!row || !row[0]) return;

        const status = row[statusIdx] || "";
        const deadlineStr = row[deadlineIdx] || "";
        const deadlineDate = parseVNDate(deadlineStr);

        // ‚ùå ƒê√£ ho√†n th√†nh
        if (!isNotCompleted(status)) return;

        // ‚ùå Kh√¥ng c√≥ h·∫°n ho·∫∑c sau ng√†y mai
        if (!deadlineDate || deadlineDate > tomorrow) return;

        html += "<tr>";

        headers.forEach((_, i) => {
            let cell = row[i] || "";

            if (
                i === statusIdx &&
                (cell.toLowerCase().includes("qu√°") ||
                 cell.toLowerCase().includes("tr·ªÖ"))
            ) {
                cell = `<span class="status-bad">${cell}</span>`;
            }

            html += `<td>${cell}</td>`;
        });

        html += "</tr>";
    });

    table.querySelector("tbody").innerHTML =
        html || `<tr>
            <td colspan="${headers.length}" class="no-data">
                Kh√¥ng c√≥ c√¥ng vi·ªác c·∫ßn theo d√µi.
            </td>
        </tr>`;
}

/* ===== L·ªäCH H·ªåP H√îM NAY ===== */
function renderTodayMeetings(rows) {
    if (!rows || rows.length < 4) return;

    const table = document.getElementById("table-meetings");
    table.querySelector("thead").innerHTML =
        "<tr>" + rows[2].map(c => `<th>${c}</th>`).join("") + "</tr>";

    const now = new Date();
    const todayStr =
        String(now.getDate()).padStart(2, "0") + "/" +
        String(now.getMonth() + 1).padStart(2, "0") + "/" +
        now.getFullYear();

    let html = "";
    let lastDate = "";
    let hasMeeting = false;

    for (let i = 3; i < rows.length; i++) {
        const row = rows[i];
        if (!row || row.length < 2) continue;

        let dateCell = row[0] ? row[0].trim() : lastDate;
        if (row[0]) lastDate = row[0].trim();

        if (dateCell.includes(todayStr)) {
            hasMeeting = true;
            html += "<tr>";
            html += `<td>${row[0] || ""}</td>`;

            for (let k = 1; k < 5; k++) {
                let cell = row[k] || "";
                if (k === 4) cell = cell.replace(/\n/g, "<br>");
                html += `<td>${cell}</td>`;
            }

            html += "</tr>";
        }
    }

    table.querySelector("tbody").innerHTML =
        hasMeeting
        ? html
        : `<tr><td colspan="5" class="no-data">
            H√¥m nay kh√¥ng c√≥ l·ªãch h·ªçp ho·∫∑c l√†m vi·ªác.
           </td></tr>`;
}

/* ===== AUTO SCROLL + RELOAD ===== */
let y = 0;
let lastTime = null;
let SPEED = 40; // px / gi√¢y (ƒë·ªïi s·ªë n√†y)
let isReloading = false;
let running = true;

function startAutoScroll() {
    const viewport = document.getElementById("viewport");
    const content = document.getElementById("scrollContent");

    function step(timestamp) {
        if (!running || isReloading) {
            lastTime = timestamp;
            requestAnimationFrame(step);
            return;
        }

        if (!lastTime) lastTime = timestamp;
        const delta = (timestamp - lastTime) / 1000; // gi√¢y
        lastTime = timestamp;

        y += SPEED * delta;

        const maxScroll = content.offsetHeight - viewport.clientHeight;

        content.style.transform = `translate3d(0, -${y}px, 0)`;

        if (y >= maxScroll) {
            isReloading = true;
            setTimeout(() => location.reload(), 3000);
            return;
        }

        requestAnimationFrame(step);
    }

    requestAnimationFrame(step);
}

init();
</script>
</body>
</html>








